# üõ† –ì–æ—Ç–æ–≤—ã–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ `sysctl.conf`, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥ **VPN-—Å–µ—Ä–≤–µ—Ä** <br>
# –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ –≤—Å–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º - –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –Ω–µ –±—É–¥–µ—Ç <br>
## üìå –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ hostvds –∏ hostkey üìå <br>

```conf
# ==========================
# üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–µ—Ç–∏
# ==========================

# –û—Ç–∫–ª—é—á–∞–µ–º IPv6 –ø–æ–ª–Ω–æ—Å—Ç—å—é (–∏—Å–∫–ª—é—á–∞–µ–º —É—Ç–µ—á–∫–∏ DNS –∏ –∞–¥—Ä–µ—Å–∞—Ü–∏—é)
net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6 = 1
net.ipv6.conf.lo.disable_ipv6 = 1

# –û—Ç–∫–ª—é—á–∞–µ–º –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é IPv6
net.ipv6.conf.all.forwarding = 0

# –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ ICMP (—Å–µ—Ä–≤–µ—Ä –Ω–µ –ø–∏–Ω–≥—É–µ—Ç—Å—è)
net.ipv4.icmp_echo_ignore_all = 1
# –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (DoS-–∑–∞—â–∏—Ç–∞)
net.ipv4.icmp_echo_ignore_broadcasts = 1
# –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –ª–æ–∂–Ω—ã–µ ICMP –æ—à–∏–±–∫–∏
net.ipv4.icmp_ignore_bogus_error_responses = 1

# ==========================
# ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏
# ==========================

# –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–∞–∫–µ—Ç–æ–≤ (–Ω—É–∂–µ–Ω –¥–ª—è BBR)
net.core.default_qdisc = fq

# –ê–ª–≥–æ—Ä–∏—Ç–º TCP congestion control ‚Äî BBR
net.ipv4.tcp_congestion_control = bbr

# ==========================
# üõ° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
# ==========================

# –í–∫–ª—é—á–∞–µ–º —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥ IPv4 (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è VPN)
net.ipv4.ip_forward = 1
````

---

## üìå –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å

1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

```bash
sudo nano /etc/sysctl.d/99-vpn.conf
```

2. –í—Å—Ç–∞–≤—å —Ç—É–¥–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ñ–∏–≥–∞.

3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```bash
sudo sysctl --system
```

4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

* IPv6 –æ—Ç–∫–ª—é—á—ë–Ω?

```bash
ip a | grep inet6
```

* –í–∫–ª—é—á—ë–Ω –ª–∏ BBR?

```bash
sysctl net.ipv4.tcp_congestion_control
```

* –†–∞–∑—Ä–µ—à—ë–Ω –ª–∏ —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥ IPv4?

```bash
sysctl net.ipv4.ip_forward
```

---
## –†–µ–∫–æ–º–µ–Ω–¥—É—é –µ—â—ë –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥–∏ –Ω–∏–∂–µ:

## üåê –û—Ç–∫–ª—é—á–µ–Ω–∏–µ IPv6 –≤ —Å–∞–º–æ–º GRUB –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç ICMP

```bash
echo "GRUB_CMDLINE_LINUX=\"ipv6.disable=1\"" | tee -a /etc/default/grub
update-grub
reboot
```
---

## üîí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ ICMP

```bash
# –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ /etc/sysctl.conf
echo "net.ipv4.icmp_echo_ignore_all = 1" >> /etc/sysctl.conf
echo "net.ipv4.icmp_echo_ignore_broadcasts = 1" >> /etc/sysctl.conf
echo "net.ipv4.icmp_ignore_bogus_error_responses = 1" >> /etc/sysctl.conf

# –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
sysctl -p
```

üëâ –¢–∞–∫–æ–π –∫–æ–Ω—Ñ–∏–≥ –ø–æ–¥—Ö–æ–¥–∏—Ç –∏–º–µ–Ω–Ω–æ –¥–ª—è **VPN-—Å–µ—Ä–≤–µ—Ä–∞**:

* IPv6 –≥–ª—É—à–∏–º (–Ω–µ—Ç —É—Ç–µ—á–µ–∫ DNS/—Ç—Ä–∞—Ñ–∏–∫–∞),
* IPv4 —Ñ–æ—Ä–≤–∞—Ä–¥–∏–º (–Ω—É–∂–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã VPN),
* BBR –≤–∫–ª—é—á—ë–Ω (—É—Å–∫–æ—Ä—è–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è),
* ICMP-–∑–∞–ø—Ä–æ—Å—ã –∑–∞–∫—Ä—ã—Ç—ã (—Å–µ—Ä–≤–µ—Ä –Ω–µ ¬´—Å–≤–µ—Ç–∏—Ç—Å—è¬ª –≤ —Å–µ—Ç–∏).
