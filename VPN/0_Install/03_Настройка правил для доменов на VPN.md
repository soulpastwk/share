# –î–æ–±–∞–≤–ª—è–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É `.ru/.—Ä—Ñ/.su` –≤ x-ui / Xray (–∏ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –Ω–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è `mail.ru`)

> –í–µ—Ä—Å–∏—è: –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è `x-ui` —Å –∫–æ–Ω—Ñ–∏–≥–æ–º json –∫–æ—Ç–æ—Ä—ã–π –≤ –í–µ–±-–ø–∞–Ω–µ–ª–∏.
> –¶–µ–ª—å: –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–æ–º–µ–Ω—ã –≤ –∑–æ–Ω–∞—Ö `.ru`, `.—Ä—Ñ` (xn--p1ai), `.su`, –Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ (white-list) –¥–ª—è `mail.ru`. –û—Å—Ç–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (inbounds, outbounds, reality –∏ —Ç.–ø.) –Ω–µ —Ç—Ä–æ–≥–∞–µ–º.

---

## 1) –í–∞–∂–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–ø—Ä–æ—á–∏—Ç–∞–π –ø–µ—Ä–µ–¥ –ø—Ä–∞–≤–∫–æ–π)

* –ü–∞–Ω–µ–ª—å **x-ui** —Ö—Ä–∞–Ω–∏—Ç —Å–≤–æ—è –∫–æ–ø–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –±–∞–∑–µ (SQLite). –ï—Å–ª–∏ –ø—Ä–∞–≤–∏—Ç—å `config.json` –≤—Ä—É—á–Ω—É—é –∏ –ø–æ—Ç–æ–º –Ω–∞–∂–∞—Ç—å ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å¬ª –≤ –≤–µ–±-–ø–∞–Ω–µ–ª–∏, –ø–∞–Ω–µ–ª—å **–ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç** `config.json`.
* –ü–æ—ç—Ç–æ–º—É –±—É–¥–µ–º –ø—Ä–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏–∏ –≤ Web-–ø–∞–Ω–µ–ª–∏ (–±–æ–ª—å—à–æ–π –∫—É—Å–æ–∫ –∫–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–µ –¥–∞—Å—Ç, –∞ —Å–µ–∫—Ü–∏—è–º–∏ –º–æ–∂–Ω–æ)
* –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞–π –±—ç–∫–∞–ø –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º.
* –ü—Ä–æ–≤–µ—Ä—è–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å JSON (Web-–∫–∞ –ø–æ–¥—Å–≤–µ—Ç–∏—Ç –µ—Å–ª–∏ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞, –≥–ª–∞–≤–Ω–æ–µ —Å–º–æ—Ç—Ä–∏ –Ω–∞ —Å–∫–æ–±–∫–∏)

---

## 1) –°—Ä–∞–∑—É —Å–∫–∞–∂—É –∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞—Ç—å –≤ –í–µ–±-–ø–∞–Ω–µ–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
  –ó–∞–º–µ—Ç–∏–ª —ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø—Ä–∞–≤–∫–∏ –∫–æ–Ω—Ñ–∏–≥–∞ - —Ç.–µ. –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å —Ç—É—Ç –¥–æ–º–µ–Ω—ã –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–æ–Ω—ã. –¢.–µ. –≤ "–ü—Ä—è–º—ã–µ –¥–æ–º–µ–Ω—ã" –ø–∏—à–µ–º `full:mail.ru`

![sc-02](https://github.com/soulpastwk/share/blob/main/media/vpn00/scr-02.png)


## 2) –ê —ç—Ç–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ –µ—Å–ª–∏, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å / –∫—É–¥–∞ –≤—Å—Ç–∞–≤–ª—è—Ç—å

üì∏ –ò–¥—ë–º –ø–æ –ø—É—Ç–∏ - –∫–∞–∫ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ –Ω–∏–∂–µ

![sc-02](https://github.com/soulpastwk/share/blob/main/media/vpn00/scr-01.png)

–í Web-–ø–∞–Ω–µ–ª–∏ –Ω–∞–π—Ç–∏ —Å–µ–∫—Ü–∏—é:

```json
"routing": {
  "domainStrategy": "AsIs",
  "rules": [
    ... // —Ç–µ–∫—É—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞
  ]
}
```

–ù—É–∂–Ω–æ **–∑–∞–º–µ–Ω–∏—Ç—å** —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–∞—Å—Å–∏–≤–∞ `rules` –Ω–∞ –Ω–æ–≤—ã–π –Ω–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª (—Å–º. –Ω–∏–∂–µ). –ü—Ä–∞–≤–∏–ª–∞ –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ –≤ —Ç–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ:

1. `api` –ø—Ä–∞–≤–∏–ª–æ ‚Äî –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π;
2. –±–ª–æ–∫ –ø–æ `geoip:private` ‚Äî –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π;
3. –∏—Å–∫–ª—é—á–µ–Ω–∏—è (white list: `mail.ru`) ‚Äî **–≤—ã—à–µ** –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏;
4. –ø—Ä–∞–≤–∏–ª–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∑–æ–Ω `.ru`, `.—Ä—Ñ`, `.su`;
5. –ø—Ä–∞–≤–∏–ª–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ–∫–ª–∞–º—ã (`geosite:category-ads-all`) ‚Äî –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –æ—Å—Ç–∞–≤–∏—Ç—å.

---

## 3) –ù–æ–≤—ã–π –±–ª–æ–∫ `routing.rules` (–∫–æ–ø–∏—Ä—É–π –ø–æ–ª–Ω–æ—Å—Ç—å—é) –∑–∞–º–µ–Ω–∏ —Ç–æ–ª—å–∫–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞ –æ—Å—Ç–∞–≤—å mail.ru

```json
"routing": {
  "domainStrategy": "AsIs",
  "rules": [
    {
      "type": "field",
      "inboundTag": [
        "api"
      ],
      "outboundTag": "api"
    },
    {
      "type": "field",
      "outboundTag": "blocked",
      "ip": [
        "geoip:private"
      ]
    },
    {
      "type": "field",
      "outboundTag": "direct",
      "ip": [
        "geoip:private"
      ]
    },
    {
      "type": "field",
      "outboundTag": "direct",
      "domain": [
        "full:mail.ru"
      ]
    },
    {
      "type": "field",
      "outboundTag": "blocked",
      "domain": [
        "regexp:.*\\.ru$",
        "regexp:.*\\.xn--p1ai$",
        "regexp:.*\\.su$"
      ]
    },
    {
      "type": "field",
      "outboundTag": "blocked",
      "domain": [
        "geosite:category-ads-all"
      ]
    }
  ]
}
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**

* `full:mail.ru` ‚Äî —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (—á—Ç–æ–±—ã –ø–æ–¥–¥–æ–º–µ–Ω–æ–≤ –Ω–µ –±—ã–ª–æ; –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –∏ –ø–æ–¥–¥–æ–º–µ–Ω ‚Äî –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `domain:mail.ru`).
* `regexp:.*\\.ru$` –∏ —Ç.–¥. ‚Äî —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –¥–æ–º–µ–Ω—ã, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–µ—Å—è –Ω–∞ `.ru`, `.xn--p1ai` (—ç—Ç–æ `.—Ä—Ñ`) –∏ `.su`.
* –ü—Ä–∞–≤–∏–ª–æ `mail.ru` **–¥–æ–ª–∂–Ω–æ —Å—Ç–æ—è—Ç—å –≤—ã—à–µ** –ø—Ä–∞–≤–∏–ª –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –∏–Ω–∞—á–µ –±—É–¥–µ—Ç –∑–∞—Ö–ª–æ–ø–Ω—É—Ç–æ.

---

* –ß—Ç–æ–±—ã –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–π –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞:

  ```json
  {
    "type": "field",
    "outboundTag": "direct",
    "domain": ["full:another.example.com"]
  }
  ```

  –∏ –ø–æ–º–µ—â–∞–π –∏—Ö **–ø–µ—Ä–µ–¥** —Å–µ–∫—Ü–∏–µ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

* –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ–¥–¥–æ–º–µ–Ω—ã `mail.ru` (–Ω–∞–ø—Ä–∏–º–µ—Ä `api.mail.ru`) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `domain:mail.ru` –≤–º–µ—Å—Ç–æ `full:`.

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ - –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è:

* –ó–∞–∫—Ä—ã—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ `.ru/.—Ä—Ñ/.su` –ø—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º VPN
* –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ-–∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä, `full:mail.ru` **–ø–µ—Ä–µ–¥** –ø—Ä–∞–≤–∏–ª–∞–º–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∑–æ–Ω `.ru/.—Ä—Ñ/.su`.

